---
layout: post
title: opencv，vieocapture｜解决使用opencv读取摄像头视频时帧率低的问题
categories: [问题记录]
description: 解决使用opencv读取摄像头视频时帧率低的问题
keywords: opencv,videocapture,摄像头
mermaid: false
sequence: false
flow: false
mathjax: false
mindmap: false
mindmap2: false
---

### 遇到问题描述
当我们用opencv自带的接口VideoCapture 打开设备自带的摄像头或者usb连接的摄像头时。对于一些高清的摄像头画面有的时候会出现帧率很低的情况(大概是6FPS)，一开始我以为是摄像头的问题，几番尝试换了几个摄像头还是一样，所以应该是软件层面的问题。

### 解决方案
1.增加USB摄像头的带宽（作用不大，只能略微提升帧率）。

在命令行输入：

```
sudo gedit /etc/default/grub
```

把

GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"


改为：

```GRUB_CMDLINE_LINUX_DEFAULT="quiet splash usbcore.usbfs_memory_mb=1024"
```

然后更新GRUB

```sudo update-grub
```

2.USB摄像头常见的输出格式有YUYV和MJPEG。YUYV是未压缩格式，数据量大，在高分辨率下极易占满USB带宽导致帧率下降。而MJPEG是压缩格式，可以显著减少数据量，从而更容易达到高帧率,在代码中做如下修改：

```cap = cv2.VideoCapture(camera_id)
# 尝试设置使用MJPEG格式（这行代码需要在设置分辨率之前或之后，但一定要在读取帧之前）
ret = cap.set(cv2.CAP_PROP_FOURCC, cv2.VideoWriter_fourcc('M','J','P','G'))
# 如果上一行设置失败（ret为False），可以尝试另一种FourCC码
# ret = cap.set(cv2.CAP_PROP_FOURCC, cv2.VideoWriter_fourcc(*"MJPG"))
cap.set(cv2.CAP_PROP_FRAME_WIDTH, 1920)
cap.set(cv2.CAP_PROP_FRAME_HEIGHT, 1080)```

最后通过方法二解决问题。
### 参考

- [https://blog.csdn.net/a435262767/article/details/103503559][1]

[1]: https://blog.csdn.net/a435262767/article/details/103503559


